---
import "../styles/global.css";
import SplashScreen from "../components/SplashScreen.astro";
import Header from "../components/Header.astro";
import Hero from "../components/Hero.astro";
import logoImage from "../assets/Logos/UNE_com.webp";
import Accesos from "../components/Accesos.astro";
import Cards_Niveles from "../components/Cards_Niveles.astro";
import Demo from "../components/demo.astro";
import CarouselCarreras from "../components/Carousel_carreras.astro";
import Tabs from "../components/Tabs.astro";
import CallAction from "../components/CallAction.astro";
import SobreUNE from "../components/SobreUNE.astro";
import DescubreUNE from "../components/DescubreUNE.astro";
import DentroUNE from "../components/DentroUNE.astro";
import Blog from "../components/Blog.astro";
import Frecuents from "../components/Faq.astro";
import GeneralCTA from "../components/GeneralCTA.astro";
import Footer from "../components/Footer.astro";

const pageTitle = "UNE - 30 Años Creyendo en Ti";
const pageDescription = "Universidad UNE - 30 años de excelencia educativa";
---

<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{pageTitle}</title>
    <meta name="description" content={pageDescription} />

    <!-- Preload crítico -->
    <link rel="preload" href={logoImage.src} as="image" type="image/png" />

    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/Favicon/favicon.ico" />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/Favicon/favicon-32x32.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/Favicon/apple-icon-180x180.png"
    />
    <link rel="manifest" href="/Favicon/manifest.json" />

    <!-- Meta adicionales para SEO -->
    <meta name="theme-color" content="#2c5aa0" />
    <meta name="robots" content="index, follow" />
  </head>

  <body class="overflow-hidden font-gotham">
    <!-- Splash Screen con carga no bloqueante -->
    <SplashScreen logoSrc={logoImage.src} />

    <!-- Contenido principal -->
    <main id="mainContent" class="main-content">
      <Header />
      <Hero />
      <Accesos />
      <Cards_Niveles />
      <CarouselCarreras />
      <Tabs />
      <CallAction />
      <SobreUNE />
      <DescubreUNE />
      <DentroUNE />
      <Blog />
      <Frecuents />
      <GeneralCTA />
      <Footer/>

      <script is:inline>
        // Función para mostrar contenido principal
        function showMainContent() {
          const mainContent = document.getElementById("mainContent");

          if (!mainContent) {
            console.error("Elemento mainContent no encontrado");
            return;
          }

          console.log("Mostrando contenido principal");

          // Mostrar el contenido principal
          mainContent.style.display = "block";

          // Usar requestAnimationFrame para una transición suave
          requestAnimationFrame(() => {
            mainContent.style.transition =
              "opacity 0.8s ease-out, transform 0.8s ease-out";
            mainContent.style.opacity = "1";
            mainContent.style.transform = "translateY(0)";

            // Permitir scroll después de la transición
            setTimeout(() => {
              document.body.classList.remove("overflow-hidden");
            }, 500);
          });
        }

        // Escuchar ambos eventos para compatibilidad
        window.addEventListener("preloader:complete", showMainContent);
        window.addEventListener("splash:complete", showMainContent);

        // Fallback en caso de que el preloader no se complete
        window.addEventListener("load", () => {
          setTimeout(() => {
            // Verificar si el preloader aún está visible
            const preloader = document.getElementById("preloader");
            const initialBlocks = document.querySelector(".initial-blocks");

            if (
              preloader &&
              preloader.style.display !== "none" &&
              preloader.style.opacity !== "0"
            ) {
              console.warn("Preloader timeout - mostrando contenido");
              showMainContent();
            } else if (
              initialBlocks &&
              initialBlocks.style.display !== "none" &&
              initialBlocks.style.opacity !== "0"
            ) {
              console.warn("Preloader timeout - mostrando contenido");
              showMainContent();
            }
          }, 5000); // 5 segundos de timeout
        });

        // Asegurar que el body tenga overflow hidden inicialmente
        document.body.classList.add("overflow-hidden");
      </script>
    </main>
  </body>
</html>
