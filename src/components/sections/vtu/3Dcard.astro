---
import logoBlanco from "@assets/Logos/UNE_blanco.webp";
import Psicologia from "@assets/Imagenes/VTU/Congresos/CONGRESOS_PSICOLGIA.webp";

export interface Props {
  className?: string;
}

const { className = "" } = Astro.props;
---

<div
  class={`relative w-full max-w-7xl mx-auto min-h-[500px] md:min-h-[500px] sm:min-h-[600px] px-4 sm:px-6 lg:px-8 ${className}`}
  style="perspective: 1500px;"
>
  <div
    class="card relative w-full h-full cursor-pointer transition-all duration-500 ease-out group"
    id="interactive-card"
    style="transform-style: preserve-3d;"
  >
    <!-- Card principal con efectos mejorados -->
    <div
      class="relative w-full h-full rounded-xl md:rounded-[2rem] shadow-[0_20px_60px_rgba(0,0,0,0.3)] md:shadow-[0_30px_80px_rgba(0,0,0,0.4)] overflow-hidden bg-gradient-to-br from-indigo-900 via-blue-800 to-purple-800 border border-white/20 backdrop-blur-sm min-h-[500px] md:min-h-[500px] sm:min-h-[600px]"
      style="transform-style: preserve-3d;"
    >
      <!-- Header superior -->
      <div
        class="absolute top-0 left-0 w-full h-16 md:h-20 bg-gradient-to-r from-indigo-900 to-blue-800 flex items-center justify-between px-4 md:px-8 z-20 border-b border-white/10"
        style="transform: translateZ(40px);"
      >
        <div class="flex items-center gap-2 md:gap-4">
          <img
            src={logoBlanco.src}
            alt="UNE Logo"
            class="w-8 h-8 md:w-12 md:h-12 object-contain brightness-125"
          />
          <div>
            <h1 class="text-white font-bold text-sm md:text-xl text-glow">
              Congreso Psicología UNE
            </h1>
            <p class="text-blue-200 text-xs md:text-sm">2025</p>
          </div>
        </div>
        <div class="text-right">
          <p class="text-white font-bold text-sm md:text-xl text-glow">Oct. 19-21 2025</p>
          <p class="text-blue-300 text-xs md:text-sm">Puerto Vallarta</p>
        </div>
      </div>

      <!-- Efectos de fondo animados -->
      <div class="absolute inset-0 opacity-20 mt-16 md:mt-20">
        <div
          class="absolute top-0 left-0 w-full h-full bg-gradient-to-br from-cyan-400/10 via-transparent to-pink-400/10 animate-pulse"
        >
        </div>
        <div
          class="absolute top-1/4 right-1/4 w-32 h-32 md:w-64 md:h-64 bg-gradient-radial from-blue-500/20 to-transparent rounded-full blur-2xl md:blur-3xl animate-bounce slow-bounce"
        >
        </div>
        <div
          class="absolute bottom-1/4 left-1/4 w-24 h-24 md:w-48 md:h-48 bg-gradient-radial from-purple-500/20 to-transparent rounded-full blur-xl md:blur-2xl"
        >
        </div>
      </div>

      <!-- Contenido principal - Layout responsivo -->
      <div class="flex flex-col md:flex-row h-full pt-16 md:pt-20 pb-4 md:pb-6">
        <!-- Sección superior en móvil / Mitad izquierda en desktop -->
        <div class="w-full md:w-1/2 flex relative py-3 md:py-6 order-2 md:order-1">
          <!-- #2025 - Posición adaptativa -->
          <div class="absolute left-2 md:left-0 top-1/2 -translate-y-1/2 md:-translate-x-4">
            <div class="transform rotate-90 origin-center">
              <h2 class="text-3xl md:text-6xl font-bold text-white/90 text-glow whitespace-nowrap">
                #2025
              </h2>
            </div>
          </div>
          
          <!-- Logo de Psicología -->
          <div class="flex-1 flex items-center justify-center pl-12 md:pl-24">
            <img 
              src={Psicologia.src}
              alt="Logo Psicología"
              class="w-32 md:w-64 object-contain drop-shadow-lg"
            />
          </div>
        </div>

        <!-- Sección inferior en móvil / Mitad derecha en desktop -->
        <div class="w-full md:w-1/2 flex flex-col justify-center p-4 md:p-6 space-y-3 md:space-y-4 order-1 md:order-2">
          <!-- Sede -->
          <div class="bg-white/10 backdrop-blur-sm rounded-lg md:rounded-xl p-2 md:p-3 border border-white/20">
            <p class="text-blue-200 text-sm md:text-base">
              Sede: <span class="text-white font-bold text-base md:text-lg">Hotel Dreams</span>
            </p>
          </div>

          <!-- Título del congreso -->
          <div class="bg-gradient-to-r from-blue-600/20 to-purple-600/20 backdrop-blur-sm rounded-lg md:rounded-xl p-3 md:p-4 border border-white/20">
            <h3 class="text-white text-lg md:text-xl font-bold leading-tight text-glow">
              "De la teoría a la práctica: La psicología y su impacto en el mundo actual"
            </h3>
          </div>

          <!-- Bienvenida -->
          <div class="space-y-2 md:space-y-3">
            <h4 class="text-yellow-400 text-lg md:text-xl font-bold text-glow">
              ¡BIENVENIDOS!
            </h4>
            <p class="text-blue-100 text-sm md:text-base leading-relaxed">
              ¿Qué lugar ocupa la psicología en el mundo que habitamos? En el segundo congreso 
              <span class="text-white font-semibold">Psicología UNE 2025</span>, exploraremos juntos las respuestas.
            </p>
          </div>
        </div>
      </div>

      <!-- Elementos de profundidad mejorados - Ocultos en móvil -->
      <div
        class="depth-layer absolute w-16 h-16 md:w-24 md:h-24 rounded-full opacity-20 blur-xl bg-gradient-to-br from-cyan-300 to-blue-500 top-4 md:top-8 right-4 md:right-8 group-hover:opacity-40 transition-all duration-500 animate-float hidden md:block"
        style="transform: translateZ(-20px);"
      >
      </div>

      <div
        class="depth-layer absolute w-24 h-24 md:w-36 md:h-36 rounded-full opacity-15 blur-2xl bg-gradient-to-br from-purple-400 to-pink-500 bottom-12 md:bottom-24 left-4 md:left-10 group-hover:opacity-35 transition-all duration-700 animate-float-delayed hidden md:block"
        style="transform: translateZ(-30px);"
      >
      </div>

      <div
        class="depth-layer absolute w-32 h-32 md:w-48 md:h-48 rounded-full opacity-10 blur-3xl bg-gradient-to-br from-indigo-400 to-purple-600 top-1/2 right-4 md:right-10 group-hover:opacity-30 transition-all duration-1000 hidden md:block"
        style="transform: translateZ(-40px);"
      >
      </div>

      <!-- Overlay de brillo en hover mejorado -->
      <div
        class="absolute inset-0 rounded-xl md:rounded-[2rem] opacity-0 transition-all duration-500 pointer-events-none bg-gradient-to-br from-white/20 via-transparent via-transparent to-white/10 group-hover:opacity-100"
        style="transform: translateZ(80px);"
      >
      </div>
    </div>
  </div>
</div>

<style>
  /* Animaciones personalizadas */
  @keyframes gradient {
    0%,
    100% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
  }

  @keyframes float {
    0%,
    100% {
      transform: translateY(0px) rotate(0deg);
    }
    50% {
      transform: translateY(-10px) rotate(5deg);
    }
  }

  @keyframes float-delayed {
    0%,
    100% {
      transform: translateY(0px) rotate(0deg);
    }
    50% {
      transform: translateY(-15px) rotate(-3deg);
    }
  }

  @keyframes border-rotate {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }

  .animate-gradient {
    background-size: 200% auto;
    animation: gradient 3s ease infinite;
  }

  .animate-float {
    animation: float 6s ease-in-out infinite;
  }

  .animate-float-delayed {
    animation: float-delayed 8s ease-in-out infinite;
    animation-delay: 2s;
  }

  .slow-bounce {
    animation-duration: 3s;
  }

  /* Efecto de brillo en texto */
  .text-glow {
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
  }

  /* Responsivo mejorado */
  @media (max-width: 768px) {
    .card {
      transform: none !important;
    }

    .depth-layer {
      transform: none !important;
    }

    .animate-float,
    .animate-float-delayed {
      animation: none;
    }

    /* Ajustes específicos para móvil */
    .text-glow {
      text-shadow: 0 0 5px rgba(255, 255, 255, 0.2);
    }
  }

  @media (max-width: 480px) {
    /* Ajustes adicionales para pantallas muy pequeñas */
    .min-h-\[500px\] {
      min-height: 550px;
    }
    
    /* Reduce el padding en pantallas muy pequeñas */
    .p-4 {
      padding: 0.75rem;
    }
    
    /* Asegura que el texto sea legible */
    .text-sm {
      font-size: 0.85rem;
    }
  }

  @media (min-width: 769px) and (max-width: 1024px) {
    /* Ajustes para tablets */
    .min-h-\[500px\] {
      min-height: 450px;
    }
  }

  @media (max-width: 640px) {
    /* Mejoras para el layout en móvil */
    .space-y-3 > :not([hidden]) ~ :not([hidden]) {
      margin-top: 0.5rem;
    }
  }
</style>

<script>
  // Función para inicializar la animación 3D
  function initializeCard() {
    const card = document.getElementById("interactive-card");
    
    // Deshabilitar efectos 3D en dispositivos móviles y tablets
    if (!card || window.innerWidth <= 1024) {
      return;
    }

    let cardPosition = null;
    let isInitialized = false;

    function updateCardPosition() {
      const rect = card.getBoundingClientRect();
      cardPosition = {
        centerX: rect.left + rect.width / 2,
        centerY: rect.top + rect.height / 2,
        width: rect.width,
        height: rect.height
      };
    }

    function handleMouseMove(e) {
      if (!cardPosition) return;

      const { centerX, centerY, width, height } = cardPosition;
      const deltaX = e.clientX - centerX;
      const deltaY = e.clientY - centerY;
      const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
      const maxDistance = Math.max(width, height);

      if (distance < maxDistance * 1.2) {
        const rotateY = (deltaX / width) * 15; // Reducido para mejor UX
        const rotateX = -(deltaY / height) * 15; // Reducido para mejor UX
        const intensity = Math.max(0, 1 - distance / (maxDistance * 1.2));
        const finalRotateX = rotateX * intensity;
        const finalRotateY = rotateY * intensity;
        const translateZ = intensity * 15; // Reducido

        card.style.transform = `perspective(1500px) rotateX(${finalRotateX}deg) rotateY(${finalRotateY}deg) translateZ(${translateZ}px) scale(${1 + intensity * 0.01})`;
      } else {
        card.style.transform = "perspective(1500px) rotateX(0deg) rotateY(0deg) translateZ(0px) scale(1)";
      }
    }

    function handleMouseEnter() {
      card.style.transition = "all 0.3s cubic-bezier(0.23, 1, 0.320, 1)";
    }

    function handleMouseLeave() {
      card.style.transition = "all 0.8s cubic-bezier(0.23, 1, 0.320, 1)";
      card.style.transform = "perspective(1500px) rotateX(0deg) rotateY(0deg) translateZ(0px) scale(1)";
    }

    function handleResize() {
      // Reinicializar solo si seguimos en desktop
      if (window.innerWidth > 1024) {
        updateCardPosition();
      } else {
        // Cleanup si cambiamos a móvil
        cleanup();
      }
    }

    function cleanup() {
      if (isInitialized) {
        document.removeEventListener("mousemove", handleMouseMove);
        card.removeEventListener("mouseenter", handleMouseEnter);
        card.removeEventListener("mouseleave", handleMouseLeave);
        window.removeEventListener("resize", handleResize);
        isInitialized = false;
      }
    }

    function initEvents() {
      if (isInitialized || window.innerWidth <= 1024) return;
      
      updateCardPosition();
      
      document.addEventListener("mousemove", handleMouseMove);
      card.addEventListener("mouseenter", handleMouseEnter);
      card.addEventListener("mouseleave", handleMouseLeave);
      window.addEventListener("resize", handleResize);
      
      isInitialized = true;
    }

    // Usar IntersectionObserver para detectar cuando la tarjeta es visible
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting && entry.intersectionRatio > 0.1) {
            // Pequeño delay para asegurar que el elemento esté completamente renderizado
            setTimeout(() => {
              initEvents();
              observer.unobserve(card); // Solo necesitamos inicializar una vez
            }, 100);
          }
        });
      },
      {
        threshold: 0.1,
        rootMargin: "50px"
      }
    );

    observer.observe(card);

    // Return cleanup function
    return cleanup;
  }

  // Inicializar cuando el DOM esté listo
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initializeCard);
  } else {
    // Si el DOM ya está listo, inicializar inmediatamente
    initializeCard();
  }
</script>